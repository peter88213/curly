<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="QM_de_CH" script:language="StarBasic">REM  *****  BASIC  *****
&apos; ----------------------------------------------------------------------
&apos; Do conversions according to german speaking Switzerland&apos;s conventions.
&apos; Konvertierungen nach den in deutsch-Schweizer Regeln.
&apos; ----------------------------------------------------------------------

Option Explicit

Dim isInitialized as boolean

&apos; ----------------------------------------------------------------------
&apos; Define language specific normal quotes
&apos; Guillemets als Standard
&apos; ----------------------------------------------------------------------
&apos; ChOpen/Close1 is for speech within speech
&apos; ChOpen/Close2 is for initial quoting
Const ChOpen1 = &quot;‹&quot;
Const ChClose1 = &quot;›&quot;
Const ChOpen2 = &quot;«&quot;
Const ChClose2 = &quot;»&quot;

&apos; ----------------------------------------------------------------------
&apos; Define language specific alternative quotes
&apos; Gänsefüsschen als Alternative
&apos; ----------------------------------------------------------------------
&apos; aChOpen/Close1 is for speech within speech
&apos; aChOpen/Close2 is for initial quoting
Const aChOpen1 = &quot;‚&quot;
Const aChClose1 = &quot;‘&quot;
Const aChOpen2 = &quot;„&quot;
Const aChClose2 = &quot;“&quot;

&apos; ----------------------------------------------------------------------
&apos; Define regular expression for direct speech
&apos; Regulärer Ausdruck für wörtliche Rede
&apos; ----------------------------------------------------------------------
Const SpeechRegex = &quot;«[^«]+»|„[^„]+“&quot;



sub Init
&apos; ----------------------------------------------------------------------
&apos; Load OOTyW basis library
&apos; ----------------------------------------------------------------------

GlobalScope.BasicLibraries.loadLibrary(&quot;OOTyW&quot;)
isInitialized = True

end sub



sub Main
&apos; ----------------------------------------------------------------------
&apos; Replace keyboard glyphs by typographical correct glyphs.
&apos; Tastaturglyphen durch  typographisch korrekte Glyphen ersetzen.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.Main
Common.En_dash
SmartQuotes
ProtectQM

end sub



sub SmartQuotes
&apos; ----------------------------------------------------------------------
&apos; Replace primes by CH style &quot;Guillemet&quot; quotation marks.
&apos; Prime durch Guillemets ersetzen.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.SubstitutePrimesII
Common.CurlyQuotes(ChOpen1,ChClose1,ChOpen2,ChClose2)

end sub



Sub TypewriterView
&apos; ----------------------------------------------------------------------
&apos; Go back to &quot;typewriter&quot; style.
&apos; Zurück zum &quot;Schreibmaschinenstil&quot;. 
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.SubstituteQuotes(ChOpen1,ChClose1,ChOpen2,ChClose2)
Common.SubstituteQuotes(aChOpen1,aChClose1,aChOpen2,aChClose2)
Revert.PrimeII
Revert.Ellipsis
Revert.Dash
Revert.UnprotectQM

End Sub



Sub SubstituteQuotes
&apos; ----------------------------------------------------------------------
&apos; Exchange format for language conversion.
&apos; Austauschformat zur Sprachumwandlung.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.SubstituteQuotes(ChOpen1,ChClose1,ChOpen2,ChClose2)
Common.SubstituteQuotes(aChOpen1,aChClose1,aChOpen2,aChClose2)

End Sub



sub ShowDirectSpeech
&apos; ----------------------------------------------------------------------
&apos; Gray-out all but direct speech.
&apos; Alles außer wörtlicher Rede ausgrauen.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.ShowDirectSpeech(SpeechRegex)

end sub



sub StandardView
&apos; ----------------------------------------------------------------------
&apos; Set all text to default color.
&apos; Den gesamten Text auf die Standardfarbe zurücksetzen.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.StandardView

end sub



Sub ProtectQM
&apos; ----------------------------------------------------------------------
&apos; Prevent hyphenation around quotation marks.
&apos; Silbentrennung vor und nach Anführungszeichen verhindern.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.ProtectQM(ChOpen2,ChClose2)
Common.ProtectQM(aChOpen2,aChClose2)

End Sub



Sub UnprotectQM
&apos; ----------------------------------------------------------------------
&apos; Allow hyphenation around quotation marks.
&apos; Nichttrennbare Leerzeichen um Ellipsen und Gedankenstriche entfernen.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.UnprotectQM(ChOpen2,ChClose2)
Common.UnprotectQM(aChOpen2,aChClose2)

End Sub



Sub AlternativeQuotes
&apos; ----------------------------------------------------------------------
&apos; Convert normal quotes into alternative quotes
&apos; Guillemets in Gänsefüsschen umwandeln.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.SubstituteQuotes(ChOpen1,ChClose1,ChOpen2,ChClose2)
Common.CurlyQuotes(aChOpen1,aChClose1,aChOpen2,aChClose2)

End Sub



Sub NormalQuotes
&apos; ----------------------------------------------------------------------
&apos; Convert alternative quotes into normal quotes
&apos; Gänsefüßchen in Guillemets umwandeln.
&apos; ----------------------------------------------------------------------

if (isInitialized = False) then Init

Common.SubstituteQuotes(aChOpen1,aChClose1,aChOpen2,aChClose2)
Common.CurlyQuotes(ChOpen1,ChClose1,ChOpen2,ChClose2)

End Sub


</script:module>